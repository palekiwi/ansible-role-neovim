---
- name: Ensure required packages are installed.
  ansible.builtin.package:
    name: "{{ item }}"
    state: present
  become: true
  loop: "{{ lsp_system_packages }}"

- name: Install lsp plugin templates.
  ansible.builtin.template:
    src: "templates/lua/plugins/{{ item.name }}.lua.j2"
    dest: "{{ plugins_dir }}/{{ item.name }}.lua"
    mode: "0644"
    force: true
  loop: "{{ lsp_plugins }}"
  when: item.name is defined
